from klefki.zkp.r1cs import R1CS


@r1cs
def qeval(x):
    y = x**3
    return y + x + 5 + 2 + z


def test_r1cs():
    assert qeval.r1cs(3) == ([1, 3, 35, 9, 27, 30],
                             [[0, 1, 0, 0, 0, 0],
                              [0, 0, 0, 1, 0, 0],
                              [0, 1, 0, 0, 1, 0],
                              [5, 0, 0, 0, 0, 1]],
                             [[0, 1, 0, 0, 0, 0],
                              [0, 1, 0, 0, 0, 0],
                              [1, 0, 0, 0, 0, 0],
                              [1, 0, 0, 0, 0, 0]],
                             [[0, 0, 0, 1, 0, 0],
                              [0, 0, 0, 0, 1, 0],
                              [0, 0, 0, 0, 0, 1],
                             [0, 0, 1, 0, 0, 0]])

    assert R1CS.verify(qeval.r1cs(3))
