import numpy as np
import pickle

with open('pickles/fortest5.pkl','rb') as f:
    crp94,mH,mHSO4,mSO4,osmST,ln_acfPM = pickle.load(f)

acfPM = np.exp(ln_acfPM)
alpha = mSO4 / (mSO4 + mHSO4)

# Compare with Simon's input script
T = crp94.temp.values

DUM = 562.694864456e0 - 102.5154e0*np.log(T) - 1.117033e-4*T**2 \
    + 0.2477538e0*T - 13273.75e0/T                         
KHSO4 = 10**(-DUM)   
        
D1=(T - 328.15e0)

b0HHSO4 =       0.227784933e0 + D1*(-3.78667718e0*1.e-3 + \
                    D1*(0.5e0*(-0.124645729e0)*1.e-3 + \
                          D1*(-0.00235747806e0*1.e-3/6.e0 + \
                           D1*(0.e0*1.e-3/12.e0)))) \

b1HHSO4 =       0.372293409e0 + D1*(1.50e0 *1.e-3 + \
                    D1*(0.5e0*0.207494846e0*1.e-3 +\
                       D1*(0.00448526492e0*1.e-3/6.e0 +\
                             D1*(0.e0*1.e-3/12.e0))))
                                    
C0HHSO4 =      -0.00560065039 + D1*(0.432400559e0*1.e-3 +
                    D1*(0.5e0*0.0203001647e0*1.e-3 +     
                        D1*(0.000417364459e0*1.e-3/6.e0 +
                            D1*(0.e0*1.e-3/12.e0))))

C1HHSO4 =     -0.05e0 + D1*(36.3457891e0*1.e-3 +
                    D1*(0.5e0*0.764767071e0*1.e-3 +
                        D1*(0.0050e0*1.e-3/6.e0 +
                           D1*(0.e0*1.e-3/12.e0))))

C0HHSO4 = C0HHSO4 / 2.e0
C1HHSO4 = C1HHSO4 / 2.e0

alphaHSO4 = 2.e0+(1.e0/T-1.e0/298.15e0)*(-1842.84293e0)

b0HSO4 =       0.0348925351e0 + D1*(4.97207803e0*1.e-3 +
                    D1*(0.5e0*0.317555182e0*1.e-3 +     
                          D1*(0.00822580341e0*1.e-3/6.e0 +
                            D1*(0.e0*1.e-3/12.e0))))

b1HSO4 =       -1.06641231e0 + D1*(-74.6840429e0*1.e-3+
                    D1*(0.5e0*(-2.26268944e0)*1.e-3 +
                           D1*(-0.0352968547e0*1.e-3/6.e0 +
                            D1*(0.e0*1.e-3/12.e0))))

C0HSO4 =       0.0216312153e0 + D1*(-0.890102670e0*1.e-3 +
                  D1*(0.5e0*(-0.0599418731e0)*1.e-3 +
                           D1*(-0.00165946145e0*1.e-3/6.e0 +
                             D1*(0.e0*1.e-3/12.e0))))

C1HSO4 =       0.e0 + D1*(-0.50e0*1.e-3 +
                    D1*(0.5e0*(-2.06768020e0)*1.e-3 +
                        D1*(0.0e0*1.e-3/6.e0 +
                            D1*(0.e0*1.e-3/12.e0))))

C0HSO4 = C0HSO4 / (2.e0*np.sqrt(2.e0))
C1HSO4 = C1HSO4 / (2.e0*np.sqrt(2.e0))

